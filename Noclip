-- Noclip.lua (แก้ไขแล้ว)
if not getgenv then getgenv = _G end
getgenv().NoclipEnabled = getgenv().NoclipEnabled or false

local Noclip = nil

local function noclip()
    if Noclip then return end
    getgenv().NoclipEnabled = true
    Noclip = game:GetService("RunService").Stepped:Connect(function()
        if getgenv().NoclipEnabled and game.Players.LocalPlayer.Character then
            for _, v in pairs(game.Players.LocalPlayer.Character:GetDescendants()) do
                if v:IsA("BasePart") and v.CanCollide then
                    v.CanCollide = false
                end
            end
        end
    end)
end

local function clip()
    getgenv().NoclipEnabled = false
    if Noclip then
        Noclip:Disconnect()
        Noclip = nil
    end
end

-- ฟังก์ชันสำหรับ Toggle เรียก
getgenv().ToggleNoclip = function(state)
    if state then
        noclip()
    else
        clip()
    end
end
