--// SERVICES
local Players = game:GetService("Players")
local lp = Players.LocalPlayer

--// VARIABLES
local savedCFrame = nil
local selectedPlayer = nil

--// GUI
local gui = Instance.new("ScreenGui")
gui.Name = "TP_Player_UI"
gui.ResetOnSpawn = false
gui.Parent = lp:WaitForChild("PlayerGui")

local main = Instance.new("Frame", gui)
main.Size = UDim2.fromOffset(260, 320)
main.Position = UDim2.fromScale(0.1, 0.2)
main.BackgroundColor3 = Color3.fromRGB(25,25,25)
main.BorderSizePixel = 0
main.Active = true
main.Draggable = true

Instance.new("UICorner", main).CornerRadius = UDim.new(0,12)

--// TITLE BAR
local title = Instance.new("TextLabel", main)
title.Size = UDim2.new(1,0,0,35)
title.Text = "TP Player"
title.BackgroundColor3 = Color3.fromRGB(35,35,35)
title.TextColor3 = Color3.new(1,1,1)
title.Font = Enum.Font.GothamBold
title.TextSize = 14

--// CLOSE BUTTON ‚ùå
local close = Instance.new("TextButton", title)
close.Size = UDim2.fromOffset(35,35)
close.Position = UDim2.new(1,-35,0,0)
close.Text = "‚úï"
close.Font = Enum.Font.GothamBold
close.TextSize = 18
close.BackgroundTransparency = 1
close.TextColor3 = Color3.fromRGB(255,80,80)

close.MouseButton1Click:Connect(function()
	gui:Destroy()
end)

--// TOGGLE BUTTON
local toggle = Instance.new("TextButton", title)
toggle.Size = UDim2.fromOffset(35,35)
toggle.Position = UDim2.new(1,-70,0,0)
toggle.Text = "-"
toggle.Font = Enum.Font.GothamBold
toggle.TextSize = 18
toggle.BackgroundTransparency = 1
toggle.TextColor3 = Color3.new(1,1,1)

--// BODY
local body = Instance.new("Frame", main)
body.Position = UDim2.fromOffset(0,35)
body.Size = UDim2.new(1,0,1,-35)
body.BackgroundTransparency = 1

--// PLAYER LIST
local list = Instance.new("ScrollingFrame", body)
list.Size = UDim2.fromOffset(240,160)
list.Position = UDim2.fromOffset(10,10)
list.CanvasSize = UDim2.new(0,0,0,0)
list.ScrollBarImageTransparency = 0.5

local layout = Instance.new("UIListLayout", list)
layout.Padding = UDim.new(0,5)

local function refreshPlayers()
	for _,v in pairs(list:GetChildren()) do
		if v:IsA("TextButton") then v:Destroy() end
	end

	for _,plr in pairs(Players:GetPlayers()) do
		if plr ~= lp then
			local btn = Instance.new("TextButton", list)
			btn.Size = UDim2.fromOffset(220,30)
			btn.Text = plr.Name
			btn.Font = Enum.Font.Gotham
			btn.TextSize = 12
			btn.BackgroundColor3 = Color3.fromRGB(45,45,45)
			btn.TextColor3 = Color3.new(1,1,1)

			btn.MouseButton1Click:Connect(function()
				selectedPlayer = plr
				title.Text = "TP Player : "..plr.Name
			end)
		end
	end
	task.wait()
	list.CanvasSize = UDim2.new(0,0,0,layout.AbsoluteContentSize.Y + 5)
end

refreshPlayers()
Players.PlayerAdded:Connect(refreshPlayers)
Players.PlayerRemoving:Connect(refreshPlayers)

--// BUTTON MAKER
local function createBtn(text,y)
	local b = Instance.new("TextButton", body)
	b.Size = UDim2.fromOffset(240,30)
	b.Position = UDim2.fromOffset(10,y)
	b.Text = text
	b.Font = Enum.Font.GothamBold
	b.TextSize = 13
	b.BackgroundColor3 = Color3.fromRGB(60,60,60)
	b.TextColor3 = Color3.new(1,1,1)
	return b
end

local saveBtn = createBtn("üìç Save Position", 180)
local tpBtn   = createBtn("‚ö° TP To Player", 220)
local backBtn = createBtn("üîô Back To Save", 260)

saveBtn.MouseButton1Click:Connect(function()
	if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
		savedCFrame = lp.Character.HumanoidRootPart.CFrame
	end
end)

tpBtn.MouseButton1Click:Connect(function()
	if selectedPlayer and selectedPlayer.Character and selectedPlayer.Character:FindFirstChild("HumanoidRootPart") then
		lp.Character.HumanoidRootPart.CFrame =
			selectedPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0,0,-3)
	end
end)

backBtn.MouseButton1Click:Connect(function()
	if savedCFrame and lp.Character then
		lp.Character.HumanoidRootPart.CFrame = savedCFrame
	end
end)

--// TOGGLE UI
local open = true
toggle.MouseButton1Click:Connect(function()
	open = not open
	body.Visible = open
	main.Size = open and UDim2.fromOffset(260,320) or UDim2.fromOffset(260,35)
	toggle.Text = open and "-" or "+"
end)
